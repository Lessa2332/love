<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Halloween Bracelet AR Adventure</title>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.3/dist/mindar-image.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: #0a0014; 
            color: #8a2be2; 
            font-family: 'Arial', sans-serif;
            overflow: hidden;
        }
        
        .screen { 
            position: absolute; 
            top: 0; left: 0; 
            width: 100%; height: 100%; 
            display: flex; flex-direction: column; 
            justify-content: center; align-items: center;
            text-align: center;
            background: radial-gradient(circle, #1a0033, #0a0014);
        }
        
        #startScreen { z-index: 1000; }
        #scanScreen { display: none; }
        #gameScreen { display: none; }
        
        /* –ú—ñ—Å—Ç–∏—á–Ω–∏–π —Å–∫–∞–Ω–µ—Ä */
        .scanner-container {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 20px auto;
            border-radius: 15px;
            overflow: hidden;
        }
        
        /* AR –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ */
        #marker-container, #markerless-container {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
        }
        
        #markerless-container { display: none; }
        
        /* –ï—Ñ–µ–∫—Ç–∏ –ø–µ—Ä–µ—Ö–æ–¥—É */
        .transition-effect {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: radial-gradient(circle at center, #8a2be2, transparent);
            opacity: 0;
            z-index: 1000;
            pointer-events: none;
        }
        
        /* –Ü–≥—Ä–æ–≤–∏–π HUD */
        .game-hud {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            padding: 15px 25px;
            border-radius: 20px;
            border: 2px solid #8a2be2;
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .power-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .power-bar {
            width: 100px;
            height: 10px;
            background: #333;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .power-fill {
            height: 100%;
            background: linear-gradient(90deg, #8a2be2, #ff00ff);
            transition: width 0.3s;
        }
        
        .ghost-counter {
            font-size: 18px;
            font-weight: bold;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ */
        .btn-halloween {
            background: linear-gradient(45deg, #8a2be2, #ff00ff);
            border: none;
            color: white;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 25px;
            cursor: pointer;
            margin: 10px;
            font-weight: bold;
            transition: transform 0.2s;
        }
        
        .btn-halloween:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(138, 43, 226, 0.5);
        }
        
        /* –ê–Ω—ñ–º–∞—Ü—ñ—ó */
        @keyframes pulse {
            0%, 100% { opacity: 0.3; transform: translate(-50%, -50%) scale(1); }
            50% { opacity: 0.6; transform: translate(-50%, -50%) scale(1.1); }
        }
        
        @keyframes energyAbsorption {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0); opacity: 0; }
        }
        
        .spooky-text {
            text-shadow: 0 0 10px #8a2be2, 0 0 20px #ff00ff;
            animation: pulse 2s infinite;
        }
        
        .instructions {
            margin: 20px 0;
            color: #a45ee5;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <!-- –°—Ç–∞—Ä—Ç–æ–≤–∏–π –µ–∫—Ä–∞–Ω -->
    <div class="screen" id="startScreen">
        <h1 class="spooky-text">üéÉ BRACELET AR ADVENTURE</h1>
        <div class="instructions">
            <p>–¢–≤—ñ–π –±—Ä–∞—Å–ª–µ—Ç - –∫–ª—é—á –¥–æ —Å–≤—ñ—Ç—É –ø—Ä–∏–≤–∏–¥—ñ–≤!</p>
            <p>–ê–∫—Ç–∏–≤—É–π –π–æ–≥–æ —Ç–∞ –≤—ñ–¥–∫—Ä–∏–π –º–∞–≥—ñ—á–Ω—ñ —Å–∏–ª–∏</p>
        </div>
        <button class="btn-halloween" onclick="startGame()">–†–û–ó–ü–û–ß–ê–¢–ò –ü–û–õ–Æ–í–ê–ù–ù–Ø</button>
        <div class="instructions">
            <p>üîç –ù–∞–ø—Ä–∞–≤ –∫–∞–º–µ—Ä—É –Ω–∞ —Å–≤—ñ–π –±—Ä–∞—Å–ª–µ—Ç</p>
            <p>üëª –õ–æ–≤–∏ –ø—Ä–∏–≤–∏–¥—ñ–≤ —Ç–∞ –∑–±–∏—Ä–∞–π –Ω–∞–≥–æ—Ä–æ–¥–∏</p>
            <p>üéÅ –û—Ç—Ä–∏–º–∞–π –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω—ñ –±–æ–Ω—É—Å–∏!</p>
        </div>
    </div>
    
    <!-- –ï–∫—Ä–∞–Ω —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –±—Ä–∞—Å–ª–µ—Ç–∞ -->
    <div class="screen" id="scanScreen">
        <h2 class="spooky-text">üîç –ê–ö–¢–ò–í–ê–¶–Ü–Ø –ë–†–ê–°–õ–ï–¢–ê</h2>
        <p class="instructions">–ù–∞–≤–µ–¥–∏ –∫–∞–º–µ—Ä—É –Ω–∞ —Å–≤—ñ–π —Ö–µ–ª–æ–≤—ñ–Ω—Å—å–∫–∏–π –±—Ä–∞—Å–ª–µ—Ç</p>
        
        <div class="scanner-container" id="scanner-container">
            <div id="marker-container"></div>
        </div>
        
        <div class="instructions">
            <p>–®—É–∫–∞–π —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π —Å–∏–º–≤–æ–ª üéÉ –Ω–∞ –±—Ä–∞—Å–ª–µ—Ç—ñ</p>
            <p id="progressText">–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–∫–∞–Ω–µ—Ä–∞...</p>
        </div>
        
        <div style="margin-top: 20px;">
            <div style="width: 200px; height: 4px; background: #333; border-radius: 2px; overflow: hidden; margin: 0 auto;">
                <div id="progressBar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #8a2be2, #ff00ff); transition: width 0.3s;"></div>
            </div>
        </div>
    </div>
    
    <!-- –Ü–≥—Ä–æ–≤–∏–π –µ–∫—Ä–∞–Ω (–±–µ–∑–º–∞—Ä–∫–µ—Ä–Ω–∏–π) -->
    <div class="screen" id="gameScreen">
        <div id="markerless-container"></div>
        <div class="game-hud">
            <div class="power-indicator">
                <span>‚ö° –ï–Ω–µ—Ä–≥—ñ—è:</span>
                <div class="power-bar">
                    <div class="power-fill" id="braceletEnergy" style="width: 100%;"></div>
                </div>
            </div>
            <div class="ghost-counter">üëª: <span id="ghostCount">0</span>/10</div>
        </div>
    </div>
    
    <!-- –ï—Ñ–µ–∫—Ç –ø–µ—Ä–µ—Ö–æ–¥—É -->
    <div class="transition-effect" id="transitionEffect"></div>

    <script>
        class MysticalScanner {
            constructor(containerId) {
                this.container = document.getElementById(containerId);
                this.canvas = document.createElement('canvas');
                this.ctx = this.canvas.getContext('2d');
                this.width = 300;
                this.height = 300;
                this.scanPosition = 0;
                this.particles = [];
                
                this.init();
            }
            
            init() {
                this.canvas.width = this.width;
                this.canvas.height = this.height;
                this.canvas.style.position = 'absolute';
                this.canvas.style.top = '0';
                this.canvas.style.left = '0';
                this.canvas.style.zIndex = '1';
                
                this.container.appendChild(this.canvas);
                
                // –°—Ç–≤–æ—Ä—é—î–º–æ —á–∞—Å—Ç–∏–Ω–∫–∏
                for (let i = 0; i < 15; i++) {
                    this.particles.push({
                        x: Math.random() * this.width,
                        y: Math.random() * this.height,
                        size: Math.random() * 3 + 1,
                        speed: Math.random() * 2 + 1,
                        angle: Math.random() * Math.PI * 2
                    });
                }
                
                this.animate();
            }
            
            draw() {
                // –û—á–∏—â–µ–Ω–Ω—è canvas
                this.ctx.clearRect(0, 0, this.width, this.height);
                
                // –¢–µ–º–Ω–∏–π —Ñ–æ–Ω
                this.ctx.fillStyle = 'rgba(10, 0, 20, 0.8)';
                this.ctx.fillRect(0, 0, this.width, this.height);
                
                // –û—Å–Ω–æ–≤–∞ —Å–∫–∞–Ω–µ—Ä–∞ - –ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫ –∑ –ø—É–Ω–∫—Ç–∏—Ä–æ–º
                this.ctx.strokeStyle = '#8a2be2';
                this.ctx.lineWidth = 3;
                this.ctx.setLineDash([10, 5]);
                this.ctx.strokeRect(20, 20, 260, 260);
                
                // –ï–Ω–µ—Ä–≥–µ—Ç–∏—á–Ω—ñ –∫–æ–ª–∞
                this.drawEnergyCircles();
                
                // –°–∫–∞–Ω—É—é—á–∏–π –ø—Ä–æ–º—ñ–Ω—å
                this.drawScanningBeam();
                
                // –ß–∞—Å—Ç–∏–Ω–∫–∏ –µ–Ω–µ—Ä–≥—ñ—ó
                this.drawEnergyParticles();
                
                // –¢–µ–∫—Å—Ç —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è
                this.drawScanningText();
            }
            
            drawEnergyCircles() {
                const time = Date.now() * 0.002;
                
                // –û—Å–Ω–æ–≤–Ω–∏–π –∫—Ä—É–≥
                this.ctx.beginPath();
                this.ctx.arc(150, 150, 80, 0, Math.PI * 2);
                this.ctx.strokeStyle = `rgba(138, 43, 226, ${0.5 + Math.sin(time) * 0.3})`;
                this.ctx.lineWidth = 2;
                this.ctx.setLineDash([]);
                this.ctx.stroke();
                
                // –ü—É–ª—å—Å—É—é—á—ñ –∫—ñ–ª—å—Ü—è
                for (let i = 0; i < 3; i++) {
                    const radius = 60 + Math.sin(time + i) * 20;
                    const alpha = 0.3 - i * 0.1;
                    
                    this.ctx.beginPath();
                    this.ctx.arc(150, 150, radius, 0, Math.PI * 2);
                    this.ctx.strokeStyle = `rgba(138, 43, 226, ${alpha})`;
                    this.ctx.lineWidth = 1;
                    this.ctx.stroke();
                }
            }
            
            drawScanningBeam() {
                this.scanPosition = (this.scanPosition + 2) % this.height;
                
                // –ì—Ä–∞–¥—ñ—î–Ω—Ç –¥–ª—è –ø—Ä–æ–º–µ–Ω—è
                const gradient = this.ctx.createLinearGradient(150, this.scanPosition - 50, 150, this.scanPosition + 50);
                gradient.addColorStop(0, 'transparent');
                gradient.addColorStop(0.5, '#8a2be2');
                gradient.addColorStop(1, 'transparent');
                
                this.ctx.strokeStyle = gradient;
                this.ctx.lineWidth = 3;
                this.ctx.setLineDash([]);
                
                this.ctx.beginPath();
                this.ctx.moveTo(150, this.scanPosition - 50);
                this.ctx.lineTo(150, this.scanPosition + 50);
                this.ctx.stroke();
                
                // –°—è–π–≤–æ –ø—Ä–æ–º–µ–Ω—è
                this.ctx.shadowColor = '#8a2be2';
                this.ctx.shadowBlur = 15;
                this.ctx.stroke();
                this.ctx.shadowBlur = 0;
            }
            
            drawEnergyParticles() {
                const time = Date.now() * 0.001;
                
                // –û–Ω–æ–≤–ª—é—î–º–æ —Ç–∞ –º–∞–ª—é—î–º–æ —á–∞—Å—Ç–∏–Ω–∫–∏
                this.particles.forEach(particle => {
                    particle.x += Math.cos(particle.angle) * particle.speed;
                    particle.y += Math.sin(particle.angle) * particle.speed;
                    
                    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –º–µ–∂
                    if (particle.x < 20 || particle.x > 280 || particle.y < 20 || particle.y > 280) {
                        particle.x = 150;
                        particle.y = 150;
                        particle.angle = Math.random() * Math.PI * 2;
                    }
                    
                    const alpha = 0.7 + Math.sin(time + particle.x * 0.1) * 0.3;
                    this.ctx.fillStyle = `rgba(138, 43, 226, ${alpha})`;
                    this.ctx.beginPath();
                    this.ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                    this.ctx.fill();
                });
            }
            
            drawScanningText() {
                const time = Date.now() * 0.001;
                const alpha = 0.5 + Math.sin(time * 3) * 0.5;
                
                this.ctx.fillStyle = `rgba(138, 43, 226, ${alpha})`;
                this.ctx.font = 'bold 14px Arial';
                this.ctx.textAlign = 'center';
                this.ctx.fillText('–°–ö–ê–ù–£–í–ê–ù–ù–Ø...', 150, 280);
            }
            
            animate() {
                this.draw();
                requestAnimationFrame(() => this.animate());
            }
        }

        class HybridARGame {
            constructor() {
                this.mindARMarker = null;
                this.mindARMarkerless = null;
                this.scanner = null;
                this.isBraceletActivated = false;
                this.scanProgress = 0;
                this.ghostsCaught = 0;
                this.braceletEnergy = 100;
                
                this.init();
            }
            
            async init() {
                // –ü–æ–∫–∞–∑—É—î–º–æ —Å—Ç–∞—Ä—Ç–æ–≤–∏–π –µ–∫—Ä–∞–Ω
                this.showScreen('startScreen');
            }
            
            async startGame() {
                this.showScreen('scanScreen');
                await this.initMarkerTracking();
                this.startScanningProgress();
            }
            
            async initMarkerTracking() {
                try {
                    // –°—Ç–≤–æ—Ä—é—î–º–æ –º—ñ—Å—Ç–∏—á–Ω–∏–π —Å–∫–∞–Ω–µ—Ä
                    this.scanner = new MysticalScanner('scanner-container');
                    
                    // –î–ª—è –¥–µ–º–æ - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –±–µ–∑–º–∞—Ä–∫–µ—Ä–Ω–∏–π —Ç—Ä–µ–∫—ñ–Ω–≥ –∑ —ñ–º—ñ—Ç–∞—Ü—ñ—î—é –º–∞—Ä–∫–µ—Ä–∞
                    this.mindARMarker = new MindARThree({
                        container: document.getElementById("marker-container"),
                        // –£ —Ä–µ–∞–ª—å–Ω–æ–º—É –¥–æ–¥–∞—Ç–∫—É —Ç—É—Ç –±—É–¥–µ imageTargetSrc –∑ —Ñ–∞–π–ª–æ–º –º–∞—Ä–∫–µ—Ä–∞
                        maxTrack: 1
                    });
                    
                    const { renderer, scene, camera } = this.mindARMarker;
                    
                    // –î–æ–¥–∞—î–º–æ —Ç–µ—Å—Ç–æ–≤—É —Å—Ü–µ–Ω—É –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó
                    const geometry = new THREE.BoxGeometry(0.5, 0.5, 0.5);
                    const material = new THREE.MeshBasicMaterial({ color: 0x8a2be2 });
                    const cube = new THREE.Mesh(geometry, material);
                    scene.add(cube);
                    
                    // –ê–Ω—ñ–º–∞—Ü—ñ—è –∫—É–±–∞
                    const animate = () => {
                        cube.rotation.x += 0.01;
                        cube.rotation.y += 0.01;
                        renderer.render(scene, camera);
                        requestAnimationFrame(animate);
                    };
                    
                    await this.mindARMarker.start();
                    animate();
                    
                } catch (error) {
                    console.error("–ü–æ–º–∏–ª–∫–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó AR:", error);
                    this.showMessage("–ü–æ–º–∏–ª–∫–∞ AR. –ü–µ—Ä–µ—Ö–æ–¥–∂—É –≤ –¥–µ–º–æ-—Ä–µ–∂–∏–º...");
                    setTimeout(() => this.simulateBraceletDetection(), 2000);
                }
            }
            
            startScanningProgress() {
                const progressInterval = setInterval(() => {
                    this.scanProgress += Math.random() * 15;
                    if (this.scanProgress > 100) this.scanProgress = 100;
                    
                    document.getElementById('progressBar').style.width = this.scanProgress + '%';
                    document.getElementById('progressText').textContent = 
                        `–°–∫–∞–Ω—É–≤–∞–Ω–Ω—è... ${Math.round(this.scanProgress)}%`;
                    
                    if (this.scanProgress >= 100 && !this.isBraceletActivated) {
                        clearInterval(progressInterval);
                        this.simulateBraceletDetection();
                    }
                }, 500);
            }
            
            simulateBraceletDetection() {
                this.showMessage("üéØ –ë—Ä–∞—Å–ª–µ—Ç –∑–Ω–∞–π–¥–µ–Ω–æ! –ê–∫—Ç–∏–≤—É—é...");
                setTimeout(() => {
                    this.onBraceletDetected();
                }, 1500);
            }
            
            async onBraceletDetected() {
                if (this.isBraceletActivated) return;
                this.isBraceletActivated = true;
                
                this.showMessage("üîÆ –ë—Ä–∞—Å–ª–µ—Ç –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ! –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–∞–≥—ñ—á–Ω–∏—Ö —Å–∏–ª...");
                
                // 1. –ü–æ–∫–∞–∑–∞—Ç–∏ –µ—Ñ–µ–∫—Ç –ø–æ–≥–ª–∏–Ω–∞–Ω–Ω—è
                await this.showAbsorptionEffect();
                
                // 2. –ü–µ—Ä–µ–π—Ç–∏ –¥–æ –±–µ–∑–º–∞—Ä–∫–µ—Ä–Ω–æ–≥–æ —Ä–µ–∂–∏–º—É
                await this.switchToMarkerlessMode();
                
                // 3. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –≥—Ä—É
                this.startGhostHuntingGame();
            }
            
            async showAbsorptionEffect() {
                const effect = document.getElementById('transitionEffect');
                effect.style.opacity = '1';
                effect.style.transition = 'all 2s';
                effect.style.background = 'radial-gradient(circle at center, #8a2be2, #ff00ff, transparent)';
                
                return new Promise(resolve => {
                    setTimeout(() => {
                        effect.style.opacity = '0';
                        setTimeout(resolve, 1000);
                    }, 2000);
                });
            }
            
            async switchToMarkerlessMode() {
                document.getElementById('scanScreen').style.display = 'none';
                document.getElementById('gameScreen').style.display = 'flex';
                
                await this.initMarkerlessTracking();
            }
            
            async initMarkerlessTracking() {
                try {
                    this.mindARMarkerless = new MindARThree({
                        container: document.getElementById("markerless-container"),
                    });
                    
                    const { renderer, scene, camera } = this.mindARMarkerless;
                    
                    // –î–æ–¥–∞—î–º–æ —Å–≤—ñ—Ç–ª–æ
                    const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
                    scene.add(ambientLight);
                    const directionalLight = new THREE.DirectionalLight(0x8a2be2, 0.8);
                    directionalLight.position.set(0, 1, 1);
                    scene.add(directionalLight);
                    
                    await this.mindARMarkerless.start();
                    renderer.setAnimationLoop(() => {
                        renderer.render(scene, camera);
                    });
                    
                } catch (error) {
                    console.error("–ü–æ–º–∏–ª–∫–∞ –±–µ–∑–º–∞—Ä–∫–µ—Ä–Ω–æ–≥–æ —Ç—Ä–µ–∫—ñ–Ω–≥—É:", error);
                    this.showMessage("–ë–µ–∑–º–∞—Ä–∫–µ—Ä–Ω–∏–π —Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ!");
                }
            }
            
            startGhostHuntingGame() {
                this.showMessage("üéÆ –ü–æ–ª—é–≤–∞–Ω–Ω—è –Ω–∞ –ø—Ä–∏–≤–∏–¥—ñ–≤ –ø–æ—á–∞–ª–æ—Å—å!");
                this.spawnGhosts();
                this.startGameLoop();
            }
            
            spawnGhosts() {
                // –Ü–º—ñ—Ç–∞—Ü—ñ—è –ø–æ—è–≤–∏ –ø—Ä–∏–≤–∏–¥—ñ–≤
                let ghostSpawnCount = 0;
                const spawnInterval = setInterval(() => {
                    if (ghostSpawnCount < 10) {
                        this.showMessage("üëª –ó'—è–≤–∏–≤—Å—è –Ω–æ–≤–∏–π –ø—Ä–∏–≤–∏–¥!");
                        ghostSpawnCount++;
                    } else {
                        clearInterval(spawnInterval);
                    }
                }, 3000);
            }
            
            catchGhost() {
                if (this.braceletEnergy <= 0) {
                    this.showMessage("‚ö° –ó–∞—Ä—è–¥ –±—Ä–∞—Å–ª–µ—Ç–∞ –∑–∞–∫—ñ–Ω—á–∏–≤—Å—è!");
                    return;
                }
                
                this.ghostsCaught++;
                this.braceletEnergy -= 10;
                
                this.updateGameUI();
                this.showMessage(`üéØ –í–ø—ñ–π–º–∞–Ω–æ –ø—Ä–∏–≤–∏–¥–∞! –ó–∞–ª–∏—à–∏–ª–æ—Å—å: ${10 - this.ghostsCaught}`);
                
                if (this.ghostsCaught >= 10) {
                    this.completeGame();
                }
            }
            
            updateGameUI() {
                document.getElementById('ghostCount').textContent = this.ghostsCaught;
                document.getElementById('braceletEnergy').style.width = this.braceletEnergy + '%';
            }
            
            startGameLoop() {
                // –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –µ–Ω–µ—Ä–≥—ñ—ó –∑ —á–∞—Å–æ–º
                const energyInterval = setInterval(() => {
                    if (this.braceletEnergy < 100) {
                        this.braceletEnergy += 0.5;
                        this.updateGameUI();
                    }
                }, 1000);
            }
            
            completeGame() {
                this.showMessage("üéâ –í–Ü–¢–ê–Ñ–ú–û! –¢–∏ –≤–ø–æ—Ä–∞–≤—Å—è –∑ —É—Å—ñ–º–∞ –ø—Ä–∏–≤–∏–¥–∞–º–∏!");
                
                setTimeout(() => {
                    const reward = {
                        title: "–ï–ö–°–ö–õ–Æ–ó–ò–í–ù–ê –ù–ê–ì–û–†–û–î–ê",
                        description: "–¢–∏ —Ä–æ–∑–±–ª–æ–∫—É–≤–∞–≤ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—É –∑–Ω–∏–∂–∫—É 20% –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω—É –ø–æ–∫—É–ø–∫—É!",
                        code: "BRACELET20"
                    };
                    
                    this.showReward(reward);
                }, 2000);
            }
            
            showScreen(screenId) {
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.style.display = 'none';
                });
                document.getElementById(screenId).style.display = 'flex';
            }
            
            showMessage(text) {
                console.log(text);
                // –ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –∫—Ä–∞—Å–∏–≤—ñ —Å–ø–ª–∏–≤–∞—é—á—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
            }
            
            showReward(reward) {
                const rewardHTML = `
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
                         background: rgba(0,0,0,0.95); display: flex; flex-direction: column;
                         justify-content: center; align-items: center; z-index: 2000;
                         color: #8a2be2; text-align: center; padding: 20px;">
                        <h1 class="spooky-text">üéÅ –í–Ü–¢–ê–Ñ–ú–û!</h1>
                        <h2>${reward.title}</h2>
                        <p style="margin: 20px 0; font-size: 18px;">${reward.description}</p>
                        <div style="background: rgba(138, 43, 226, 0.2); padding: 20px; border-radius: 15px; border: 2px solid #8a2be2;">
                            <h3 style="margin-bottom: 10px;">–¢–í–Ü–ô –ü–†–û–ú–û–ö–û–î:</h3>
                            <div style="font-size: 28px; letter-spacing: 3px; font-weight: bold; color: #ff00ff;">${reward.code}</div>
                        </div>
                        <button class="btn-halloween" onclick="location.reload()" style="margin-top: 30px;">–ì–†–ê–¢–ò –©–ï –†–ê–ó</button>
                    </div>
                `;
                
                document.body.insertAdjacentHTML('beforeend', rewardHTML);
            }
        }
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
        let gameInstance;
        
        function startGame() {
            gameInstance = new HybridARGame();
            gameInstance.startGame();
        }
        
        // –û–±—Ä–æ–±–Ω–∏–∫ –∫–ª—ñ–∫—ñ–≤ –¥–ª—è –∑–ª–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–∏–≤–∏–¥—ñ–≤
        document.addEventListener('click', function(e) {
            if (gameInstance && gameInstance.isBraceletActivated) {
                // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —â–æ –∫–ª—ñ–∫ –Ω–µ –ø–æ –∫–Ω–æ–ø—Ü—ñ
                if (!e.target.classList.contains('btn-halloween')) {
                    gameInstance.catchGhost();
                }
            }
        });
    </script>
</body>
</html>
