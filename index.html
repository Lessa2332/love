<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>üïØÔ∏è –°–≤—ñ—á–∫–∞ –ø–∞–º'—è—Ç—ñ</title>

  <!-- ‚úÖ A-Frame –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –ü–ï–†–®–ò–ú -->
  <script src="https://unpkg.com/aframe@1.6.0/dist/aframe.min.js"></script>
  <!-- ‚úÖ MindAR –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –ü–Ü–°–õ–Ø A-Frame -->
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>

  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: black;
      font-family: "Comic Sans MS", cursive;
    }
    #loader {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      color: #ffd580;
      background: rgba(0, 0, 0, 0.7);
      padding: 10px 20px;
      border-radius: 10px;
      font-size: 18px;
      z-index: 999;
      text-align: center;
    }
  </style>
</head>

<body>
  <div id="loader">üïØÔ∏è –ù–∞–≤–µ–¥–∏ –∫–∞–º–µ—Ä—É –Ω–∞ –º–∞—Ä–∫–µ—Ä</div>

  <a-scene
    mindar-image="imageTargetSrc: ./targets.mind; autoStart: true; showStats: false;"
    color-space="sRGB"
    embedded
    vr-mode-ui="enabled: false"
    device-orientation-permission-ui="enabled: false"
    renderer="colorManagement: true; alpha: true;"
  >
    <a-assets>
      <!-- –î–æ–¥–∞—î–º–æ —à—Ä–∏—Ñ—Ç –≤ assets -->
      <a-asset-item id="dejaVuFont" src="https://cdn.aframe.io/fonts/DejaVu-sdf.fnt"></a-asset-item>
    </a-assets>

    <a-camera position="0 0 0" active="false"></a-camera>

    <!-- üïØÔ∏è –°–≤—ñ—á–∫–∞ -->
    <a-entity mindar-image-target="targetIndex: 0" id="candleTarget">
      <!-- –∫–æ—Ä–ø—É—Å -->
      <a-cylinder id="candle" position="0 0 0" radius="0.1" height="0.5" color="#fff5e1"></a-cylinder>
      <!-- –≥–Ω—ñ—Ç -->
      <a-cylinder position="0 0.27 0" radius="0.004" height="0.05" color="#333"></a-cylinder>
      <!-- –ø–æ–ª—É–º'—è -->
      <a-sphere id="flame" position="0 0.35 0" radius="0.05" color="#ff9c00" emissive="#ff9c00" visible="true">
        <a-animation attribute="scale" from="1 1 1" to="1.3 1.3 1.3" direction="alternate" dur="500" repeat="indefinite"></a-animation>
        <a-animation attribute="position" from="0 0.35 0" to="0 0.38 0" direction="alternate" dur="500" repeat="indefinite"></a-animation>
      </a-sphere>
      <!-- —Å–≤—ñ—Ç–ª–æ -->
      <a-light id="flameLight" type="point" color="#ffb347" position="0 0.35 0" intensity="1" distance="2" decay="1"></a-light>
      <!-- –¥–∏–º -->
      <a-entity id="smoke" visible="false">
        <a-sphere position="0 0.45 0" radius="0.03" color="#cccccc" opacity="0.3">
          <a-animation attribute="position" from="0 0.45 0" to="0 0.7 0" dur="1000" easing="ease-out" repeat="indefinite"></a-animation>
          <a-animation attribute="opacity" from="0.3" to="0" dur="1000" repeat="indefinite"></a-animation>
        </a-sphere>
      </a-entity>
      <!-- –Ω–∞–ø–∏—Å -->
      <a-text id="candleText" value="–ü–∞–º'—è—Ç–∞—î–º–æ üíõüíô" position="0 0.7 0" align="center" color="#ffd580" width="2"></a-text>
    </a-entity>

    <a-sky color="#000"></a-sky>
  </a-scene>

  <script>
    // –ß–µ–∫–∞—î–º–æ –ø–æ–≤–Ω–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏
    window.addEventListener('DOMContentLoaded', () => {
      console.log('DOM –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ');
      
      const scene = document.querySelector('a-scene');
      
      scene.addEventListener('loaded', () => {
        console.log('A-Frame —Å—Ü–µ–Ω–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞');
        
        const flame = document.getElementById('flame');
        const light = document.getElementById('flameLight');
        const smoke = document.getElementById('smoke');
        const loader = document.getElementById('loader');
        const target = document.getElementById('candleTarget');

        let isLit = true;

        function toggleCandle() {
          if (isLit) {
            flame.setAttribute('visible', false);
            light.setAttribute('intensity', 0);
            smoke.setAttribute('visible', true);
            isLit = false;
          } else {
            flame.setAttribute('visible', true);
            light.setAttribute('intensity', 1);
            smoke.setAttribute('visible', false);
            isLit = true;
          }
        }

        scene.addEventListener('click', toggleCandle);

        target.addEventListener('targetFound', () => {
          console.log('–ú–∞—Ä–∫–µ—Ä –∑–Ω–∞–π–¥–µ–Ω–æ');
          loader.style.display = 'none';
        });

        target.addEventListener('targetLost', () => {
          console.log('–ú–∞—Ä–∫–µ—Ä –≤—Ç—Ä–∞—á–µ–Ω–æ');
          loader.style.display = 'block';
        });
      });
    });
  </script>
</body>
</html>
