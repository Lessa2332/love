<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>üïØÔ∏è –°–≤—ñ—á–∫–∞ –ø–∞–º‚Äô—è—Ç—ñ</title>

  <!-- ‚úÖ A-Frame -->
  <script src="https://cdn.jsdelivr.net/npm/aframe@1.6.0/dist/aframe.min.js"></script>

  <!-- ‚úÖ MindAR -->
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js" defer></script>

  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: black;
      font-family: "Comic Sans MS", cursive;
    }
    #loader {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      color: #ffd580;
      background: rgba(0, 0, 0, 0.7);
      padding: 10px 20px;
      border-radius: 10px;
      font-size: 18px;
      z-index: 999;
      text-align: center;
    }
  </style>
</head>

<body>
  <div id="loader">üïØÔ∏è –ù–∞–≤–µ–¥–∏ –∫–∞–º–µ—Ä—É –Ω–∞ –º–∞—Ä–∫–µ—Ä</div>

  <a-scene
    mindar-image="imageTargetSrc: ./targets.mind; autoStart: true; showStats: true;"
    color-space="sRGB"
    embedded
    vr-mode-ui="enabled: false"
    device-orientation-permission-ui="enabled: false"
    renderer="colorManagement: true; alpha: true;"
  >
    <a-assets></a-assets>

    <a-camera position="0 0 1.5"></a-camera>

    <!-- üïØÔ∏è –°–≤—ñ—á–∫–∞ -->
    <a-entity mindar-image-target="targetIndex: 0" id="candleTarget">

      <!-- –∫–æ—Ä–ø—É—Å -->
      <a-cylinder id="candle" position="0 0 0" radius="0.1" height="0.5" color="#fff5e1"></a-cylinder>

      <!-- –≥–Ω—ñ—Ç -->
      <a-cylinder position="0 0.27 0" radius="0.004" height="0.05" color="#333"></a-cylinder>

      <!-- –ø–æ–ª—É–º‚Äô—è -->
      <a-sphere id="flame" position="0 0.35 0" radius="0.05" color="#ff9c00" emissive="#ff9c00" visible="true">
        <a-animation attribute="scale" from="1 1 1" to="1.3 1.3 1.3"
          direction="alternate" dur="500" repeat="indefinite"></a-animation>
        <a-animation attribute="position" from="0 0.35 0" to="0 0.38 0"
          direction="alternate" dur="500" repeat="indefinite"></a-animation>
      </a-sphere>

      <!-- —Å–≤—ñ—Ç–ª–æ -->
      <a-light id="flameLight" type="point" color="#ffb347" position="0 0.35 0" intensity="1" distance="2" decay="1">
        <a-animation attribute="intensity" from="0.8" to="1.2"
          direction="alternate" dur="400" repeat="indefinite"></a-animation>
      </a-light>

      <!-- –¥–∏–º -->
      <a-entity id="smoke" visible="false">
        <a-sphere position="0 0.45 0" radius="0.03" color="#cccccc" opacity="0.3">
          <a-animation attribute="position" from="0 0.45 0" to="0 0.7 0"
            dur="1000" easing="ease-out" repeat="indefinite"></a-animation>
          <a-animation attribute="opacity" from="0.3" to="0"
            dur="1000" repeat="indefinite"></a-animation>
        </a-sphere>
      </a-entity>

      <!-- –Ω–∞–ø–∏—Å -->
      <a-text id="candleText" value="–ü–∞–º‚Äô—è—Ç–∞—î–º–æ üíõüíô"
              position="0 0.7 0" align="center"
              color="#ffd580" width="2" font="https://cdn.aframe.io/fonts/DejaVu-sdf.fnt"></a-text>
    </a-entity>

    <a-sky color="#000"></a-sky>
  </a-scene>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const flame = document.getElementById('flame');
      const light = document.getElementById('flameLight');
      const smoke = document.getElementById('smoke');
      const scene = document.querySelector('a-scene');
      const loader = document.getElementById('loader');
      const target = document.getElementById('candleTarget');

      let isLit = true;

      function toggleCandle() {
        if (isLit) {
          // üí® –ó–≥–∞—Å–∞–Ω–Ω—è
          flame.setAttribute('visible', false);
          light.setAttribute('intensity', 0);
          smoke.setAttribute('visible', true);
          isLit = false;
        } else {
          // üî• –ó–∞–ø–∞–ª–µ–Ω–Ω—è
          flame.setAttribute('visible', true);
          light.setAttribute('intensity', 1);
          smoke.setAttribute('visible', false);
          isLit = true;
        }
      }

      // üîÅ –î–æ—Ç–∏–∫ –ø–æ —Å—Ü–µ–Ω—ñ ‚Äî –∑–∞–ø–∞–ª–∏—Ç–∏ –∞–±–æ –∑–∞–≥–∞—Å–∏—Ç–∏ (–¥–ª—è –¥–µ—Å–∫—Ç–æ–ø —ñ –º–æ–±—ñ–ª—å–Ω–∏—Ö)
      scene.addEventListener('click', toggleCandle);
      scene.addEventListener('touchstart', toggleCandle);

      // üëÅÔ∏è –ö–æ–ª–∏ –º–∞—Ä–∫–µ—Ä –∑–Ω–∞–π–¥–µ–Ω–æ
      target.addEventListener('targetFound', () => {
        loader.style.display = 'none';
      });

      // üëª –ö–æ–ª–∏ –º–∞—Ä–∫–µ—Ä –∑–Ω–∏–∫
      target.addEventListener('targetLost', () => {
        loader.style.display = 'block';
      });
    });
  </script>
</body>
</html>
