<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–≤–æ—î —Å–µ—Ä—Ü–µ –±'—î—Ç—å—Å—è –≤—ñ–¥ –º–æ–≥–æ –≥–æ–ª–æ—Å—É ‚ù§Ô∏è</title>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Arial', sans-serif; }
        #ui {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            text-align: center;
            z-index: 1000;
            background: rgba(255, 20, 147, 0.25);
            padding: 15px 40px;
            border-radius: 30px;
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 105, 180, 0.3);
        }
        #status { font-size: 20px; margin-bottom: 8px; }
        #words { 
            font-size: 28px; 
            color: #ff69b4; 
            font-weight: bold; 
            text-shadow: 0 0 20px #ff1493;
            min-height: 40px;
        }
        .pulse { animation: bigpulse 0.6s cubic-bezier(0.4, 0, 0.6, 1); }
        @keyframes bigpulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.25); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>

<div id="ui">
    <div id="status">–ù–∞—Ç–∏—Å–Ω–∏ –±—É–¥—å-–¥–µ —ñ —Å–∫–∞–∂–∏ —Å–ª–æ–≤–∞ –∫–æ—Ö–∞–Ω–Ω—è...</div>
    <div id="words"></div>
</div>

<a-scene background="color: #000011" embedded style="width:100%; height:100vh;">

    <!-- –†–ï–ê–õ–¨–ù–ï –°–ï–†–¶–ï –ó –ü–†–ò–ú–ò–¢–ò–í–Ü–í -->
    <a-entity id="true-heart" position="0 1.6 -3" rotation="0 0 0">

        <!-- –õ—ñ–≤–∞ –ø–æ–ª–æ–≤–∏–Ω–∫–∞ —Å–µ—Ä—Ü—è -->
        <a-sphere position="-0.25 0.3 0" radius="0.65"
                  material="color:#ff1744; emissive:#ff1744; emissiveIntensity:0.4; metalness:0.3; roughness:0.2"
                  class="heart-part"></a-sphere>

        <!-- –ü—Ä–∞–≤–∞ –ø–æ–ª–æ–≤–∏–Ω–∫–∞ —Å–µ—Ä—Ü—è -->
        <a-sphere position="0.25 0.3 0" radius="0.65"
                  material="color:#ff1744; emissive:#ff1744; emissiveIntensity:0.4; metalness:0.3; roughness:0.2"
                  class="heart-part"></a-sphere>

        <!-- –í–µ—Ä—Ö–Ω—è –≤–∏—ó–º–∫–∞ (–≤—ñ–¥–Ω—ñ–º–∞—î–º–æ –∫–æ—Ä–æ–±–∫—É –∑–≤–µ—Ä—Ö—É) -->
        <a-box position="0 0.9 0" scale="1.4 0.8 1.4" rotation="0 0 0"
               material="color:#000; opacity:0" 
               visible="false" class="heart-cut"></a-box>

        <!-- –í–Ω—É—Ç—Ä—ñ—à–Ω—î —è–¥—Ä–æ ‚Äî —Å–≤—ñ—Ç–∏—Ç—å—Å—è —Å–∏–ª—å–Ω—ñ—à–µ -->
        <a-sphere id="core" position="0 0.25 0" radius="0.4"
                  material="color:#ff69b4; emissive:#ff69b4; emissiveIntensity:1; shader:flat; transparent:true; opacity:0.8">
        </a-sphere>

        <!-- Halo –Ω–∞–≤–∫–æ–ª–æ —Å–µ—Ä—Ü—è -->
        <a-ring id="halo" position="0 0.25 -0.01" radius-inner="0.9" radius-outer="1.4" rotation="-90 0 0"
                material="color:#ff1493; shader:flat; side:double; transparent:true; opacity:0.6">
        </a-ring>

        <!-- –ß–∞—Å—Ç–∏–Ω–∫–∏ -->
        <a-entity id="particles"></a-entity>
    </a-entity>

    <!-- –§–æ–Ω–æ–≤—ñ –ø–ª–∞–≤–∞—é—á—ñ —Å–µ—Ä–¥–µ—á–∫–∞ -->
    <a-entity id="bg-hearts"></a-entity>

    <!-- –°–≤—ñ—Ç–ª–æ -->
    <a-light type="ambient" color="#440033" intensity="0.4"></a-light>
    <a-light type="point" color="#ff3399" intensity="3" distance="10" position="0 3 -2"></a-light>

    <!-- –ö–∞–º–µ—Ä–∞ -->
    <a-camera position="0 1.6 1"></a-camera>
</a-scene>

<script>
class VoiceHeart {
    constructor() {
        this.intensity = 0.4;
        this.lastLoveTime = 0;
        this.loveWords = ['–∫–æ—Ö–∞–Ω–Ω—è','–ª—é–±–ª—é','—Å–µ—Ä—Ü–µ','–æ–±—ñ–π–º–∏','–ø–æ—Ü—ñ–ª—É–Ω–æ–∫','–º–∏–ª–∏–π','–∫–æ—Ö–∞–Ω–∏–π','–∑–∞–∫–æ—Ö–∞–Ω–∞','—á–∞—Ä—ñ–≤–Ω–∞','–ø—Ä–µ–∫—Ä–∞—Å–Ω–∞','–Ω—ñ–∂–Ω—ñ—Å—Ç—å','—â–∞—Å—Ç—è','–º—Ä—ñ—è','–ø—Ä–∏—Å—Ç—Ä–∞—Å—Ç—å','–¥—É—à–∞','—Ä–∞–∑–æ–º','–≤—ñ—á–Ω–æ','—Ç–∏','—Ç–µ–±–µ'];

        this.init();
    }

    init() {
        this.setupVoice();
        this.createBgHearts();
        setInterval(() => this.breathe(), 100);
    }

    setupVoice() {
        if (!('SpeechRecognition' in window || 'webkitSpeechRecognition' in window)) {
            document.getElementById('status').innerHTML = '–ë—Ä–∞—É–∑–µ—Ä –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î –º—ñ–∫—Ä–æ—Ñ–æ–Ω';
            return;
        }

        const SpeechRecognition = window.SpeechRecognition || webkitSpeechRecognition;
        const recognition = new SpeechRecognition();
        recognition.lang = 'uk-UA';
        recognition.continuous = true;
        recognition.interimResults = true;

        recognition.onresult = (e) => {
            let text = '';
            for (let i = e.resultIndex; i < e.results.length; i++) {
                text += e.results[i][0].transcript;
            }
            this.reactToVoice(text.toLowerCase());
        };

        recognition.onerror = () => {
            document.getElementById('status').textContent = '–ü–æ–º–∏–ª–∫–∞ –º—ñ–∫—Ä–æ—Ñ–æ–Ω–∞... —Å–ø—Ä–æ–±—É–π —â–µ';
        };

        document.body.onclick = () => {
            if (recognition._started) return;
            recognition.start();
            recognition.start();
            document.getElementById('status').innerHTML = '–°–ª—É—Ö–∞—é —Ç–µ–±–µ... ‚ù§Ô∏è';
            recognition._started = true;
        };

        document.getElementById('status').textContent = '–ù–∞—Ç–∏—Å–Ω–∏ —ñ –≥–æ–≤–æ—Ä–∏...';
    }

    reactToVoice(text) {
        {
        document.getElementById('words').textContent = text;

        const hasLove = this.loveWords.some(w => text.includes(w));
        if (hasLove) {
            this.lastLoveTime = Date.now();
            this.intensity = Math.min(1.0, this.intensity + 0.25);

            // –í–µ–ª–∏–∫–∏–π –ø—É–ª—å—Å
            document.getElementById('words').classList.add('pulse');
            setTimeout(() => document.getElementById('words').classList.remove('pulse'), 600);

            this.explodeLove();
            document.getElementById('status').innerHTML = '–Ø —á—É—é —Ç–≤–æ—î –∫–æ—Ö–∞–Ω–Ω—è!!! ‚ù§Ô∏è‚Äçüî•';
        }
    }

    breathe() {
        // –ó–≥–∞—Å–∞–Ω–Ω—è, —è–∫—â–æ –¥–∞–≤–Ω–æ –Ω–µ —á—É–≤ –ª—é–±–æ–≤—ñ
        if (Date.now() - this.lastLoveTime > 4000) {
            this.intensity = Math.max(0.3, this.intensity - 0.008);
        }

        const heart = document.querySelector('#true-heart');
        const core = document.querySelector('#core');
        const halo = document.querySelector('#halo');

        const pulseScale = 1 + this.intensity * 0.4;
        const pulseSpeed = 800 / (this.intensity + 0.5);

        heart.setAttribute('animation__pulse', {
            property: 'scale',
            to: `${pulseScale} ${pulseScale} ${pulseScale}`,
            dur: pulseSpeed,
            dir: 'alternate',
            loop: true,
            easing: 'easeInOutSine'
        });

        core.setAttribute('material', 'emissiveIntensity', this.intensity * 1.8);
        halo.setAttribute('material', 'opacity', this.intensity * 0.8);

        // –ö–æ–ª—ñ—Ä —Å–µ—Ä—Ü—è —Å—Ç–∞—î —è—Å–∫—Ä–∞–≤—ñ—à–∏–º –≤—ñ–¥ –∫–æ—Ö–∞–Ω–Ω—è
        const r = Math.min(255, 255 * this.intensity);
        const color = `#ff${(50 + 100*this.intensity).toFixed(0).padStart(2,'0')}99`;
        document.querySelectorAll('.heart-part').forEach(el => {
            el.setAttribute('material', { color, emissive: color, emissiveIntensity: this.intensity });
        });
    }

    explodeLove() {
        const container = document.getElementById('particles');
        for (let i = 0; i < 12; i++) {
            const p = document.createElement('a-entity');
            const angle = Math.random() * Math.PI * 2;
            const force = 1 + Math.random() * 3;
            const x = Math.cos(angle) * force;
            const y = Math.sin(angle) * force + 1;
            const z = (Math.random() - 0.5) * 2;

            p.setAttribute('geometry', 'primitive: tetrahedron; radius: 0.15');
            p.setAttribute('material', 'color:#ff69b4; emissive:#ff1493; emissiveIntensity:1; metalness:0.8');
            p.setAttribute('position', '0 0.25 0');

            p.setAttribute('animation', {
                property: 'position',
                to: `${x} ${y} ${z}`,
                dur: 1500 + Math.random() * 1000,
                easing: 'easeOutCubic'
            });
            p.setAttribute('animation__rot', {
                property: 'rotation',
                to: `${Math.random()*720} ${Math.random()*720} ${Math.random()*720}`,
                dur: 2000,
                easing: 'linear',
                loop: true
            });
            p.setAttribute('animation__fade', {
                property: 'scale',
                to: '0 0 0',
                dur: 2000,
                delay: 800
            });

            container.appendChild(p);
            setTimeout(() => p.remove(), 3000);
        }
    }

    createBgHearts() {
        const container = document.getElementById('bg-hearts');
        for (let i = 0; i < 10; i++) {
            const h = document.createElement('a-entity');
            const r = 4 + Math.random() * 4;
            const angle = Math.random() * Math.PI * 2;
            const height = 0.5 + Math.random() * 3;

            h.setAttribute('gltf-model', '#heartModel'); // –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –º–æ–¥–µ–ª—å, –∞–ª–µ –ø—Ä–∞—Ü—é—î —ñ –±–µ–∑
            h.setAttribute('scale', '0.3 0.3 0.3');
            h.setAttribute('position', `${Math.cos(angle)*r} ${height} ${Math.sin(angle)*r}`);
            h.setAttribute('material', 'color:#ff69b4; emissive:#ff1493; emissiveIntensity:0.5; transparent:true; opacity:0.7');

            h.setAttribute('animation', {
                property: 'rotation',
                to: '0 360 0',
                dur: 10000 + Math.random()*10000,
                loop: true,
                easing: 'linear'
            });
            h.setAttribute('animation__float', {
                property: 'position.y',
                to: height + 1.5,
                dur: 4000 + Math.random()*4000,
                dir: 'alternate',
                loop: true,
                easing: 'easeInOutSine'
            });

            container.appendChild(h);
        }
    }
}

// –ó–∞–ø—É—Å–∫
new VoiceHeart();
</script>
</body>
</html>
