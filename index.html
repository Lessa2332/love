<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∞–≥—ñ—á–Ω–µ —Å–µ—Ä—Ü–µ –∫–æ—Ö–∞–Ω–Ω—è</title>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <style>
        body {
            margin: 0;
            background: #000;
            overflow: hidden;
            font-family: 'Arial', sans-serif;
        }
        #ui {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            text-align: center;
            z-index: 1000;
            background: rgba(255, 0, 85, 0.3);
            padding: 15px 30px;
            border-radius: 25px;
            backdrop-filter: blur(10px);
        }
        #status {
            font-size: 18px;
            margin-bottom: 10px;
        }
        #words {
            font-size: 24px;
            color: #ff4081;
            font-weight: bold;
            min-height: 32px;
        }
        .pulse {
            animation: pulse 0.5s ease-in-out;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <div id="ui">
        <div id="status">üé§ –ì–æ–≤–æ—Ä–∏ —Å–ª–æ–≤–∞ –∫–æ—Ö–∞–Ω–Ω—è...</div>
        <div id="words"></div>
    </div>

    <a-scene background="color: #000011">
        <!-- –ú–∞–≥—ñ—á–Ω–µ —Å–µ—Ä—Ü–µ -->
        <a-entity id="magic-heart" position="0 1.5 -3">
            <!-- –û—Å–Ω–æ–≤–Ω–µ —Å–µ—Ä—Ü–µ -->
            <a-entity class="heart-main" geometry="primitive: sphere; radius: 0.5"
                     material="color: #ff0055; shader: flat; emissive: #ff0055; emissiveIntensity: 0.3"
                     animation="property: scale; to: 1.2 1.2 1.2; dur: 500; easing: easeInOutQuad; loop: true; dir: alternate">
            </a-entity>
            
            <!-- –í–Ω—É—Ç—Ä—ñ—à–Ω—î —Å–≤—ñ—Ç—ñ–Ω–Ω—è -->
            <a-entity class="heart-glow" geometry="primitive: sphere; radius: 0.6"
                     material="color: #ff1493; transparent: true; opacity: 0.3; shader: flat"
                     animation="property: scale; to: 1.1 1.1 1.1; dur: 400; easing: easeInOutQuad; loop: true; dir: alternate">
            </a-entity>
            
            <!-- –ß–∞—Å—Ç–∏–Ω–∫–∏ —Å–≤—ñ—Ç—ñ–Ω–Ω—è –Ω–∞–≤–∫–æ–ª–æ -->
            <a-entity id="heart-particles"></a-entity>
        </a-entity>

        <!-- –î–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ -->
        <a-entity id="floating-hearts"></a-entity>
        
        <!-- –ö–∞–º–µ—Ä–∞ -->
        <a-camera position="0 1.6 0"></a-camera>
        
        <!-- –î–∂–µ—Ä–µ–ª–∞ —Å–≤—ñ—Ç–ª–∞ -->
        <a-light type="point" color="#ff0066" intensity="2" position="2 3 2"></a-light>
        <a-light type="point" color="#ff1493" intensity="1.5" position="-2 2 -1"></a-light>
        <a-light type="ambient" color="#4455ff" intensity="0.3"></a-light>
    </a-scene>

    <script>
        class MagicHeart {
            constructor() {
                this.recognition = null;
                this.isListening = false;
                this.heartbeatInterval = null;
                this.lastSpeechTime = 0;
                this.heartIntensity = 0.3;
                this.loveWords = [
                    '–∫–æ—Ö–∞–Ω–Ω—è', '–ª—é–±–æ–≤', '–ª—é–±–∏–π', '–∫–æ—Ö–∞–Ω–∏–π', '–º–∏–ª–∏–π', '—Å–µ—Ä—Ü–µ', '—â–∞—Å—Ç—è',
                    '–Ω—ñ–∂–Ω—ñ—Å—Ç—å', '—Ç—É—Ä–±–æ—Ç–∞', '–ø—Ä–∏—Å—Ç—Ä–∞—Å—Ç—å', '—Ä–æ–º–∞–Ω—Ç–∏–∫–∞', '–æ–±—ñ–π–º–∏', '–ø–æ—Ü—ñ–ª—É–Ω–æ–∫',
                    '–∑–∞–∫–æ—Ö–∞–Ω–∏–π', '–º—Ä—ñ—è', '—á—É–¥–æ–≤–∏–π', '–ø—Ä–µ–∫—Ä–∞—Å–Ω–∏–π', '—á–∞—Ä—ñ–≤–Ω–∏–π', '–Ω–µ–∑–∞–±—É—Ç–Ω—ñ–π'
                ];
                
                this.init();
            }

            init() {
                this.setupSpeechRecognition();
                this.createFloatingHearts();
                this.startHeartbeat();
                
                // –ü–æ—á–∞—Ç–∫–æ–≤–∞ –∞–Ω—ñ–º–∞—Ü—ñ—è
                this.animateHeart(0.5);
            }

            setupSpeechRecognition() {
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    this.recognition = new SpeechRecognition();
                    this.recognition.continuous = true;
                    this.recognition.interimResults = true;
                    this.recognition.lang = 'uk-UA';

                    this.recognition.onstart = () => {
                        this.isListening = true;
                        this.updateStatus('üé§ –°–ª—É—Ö–∞—é —Ç–≤–æ—ó —Å–ª–æ–≤–∞...', '#4CAF50');
                    };

                    this.recognition.onresult = (event) => {
                        let finalTranscript = '';
                        let interimTranscript = '';

                        for (let i = event.resultIndex; i < event.results.length; i++) {
                            const transcript = event.results[i][0].transcript;
                            if (event.results[i].isFinal) {
                                finalTranscript += transcript;
                            } else {
                                interimTranscript += transcript;
                            }
                        }

                        this.processSpeech(finalTranscript || interimTranscript);
                    };

                    this.recognition.onerror = (event) => {
                        console.log('–ü–æ–º–∏–ª–∫–∞ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è:', event.error);
                        this.updateStatus('‚ùå –ü–æ–º–∏–ª–∫–∞ –º—ñ–∫—Ä–æ—Ñ–æ–Ω–∞', '#ff4444');
                    };

                    this.recognition.onend = () => {
                        this.isListening = false;
                        if (Date.now() - this.lastSpeechTime > 3000) {
                            this.updateStatus('üé§ –ù–∞—Ç–∏—Å–Ω–∏ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó', '#ff4081');
                        }
                    };

                    // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∫–ª—ñ–∫—É
                    document.addEventListener('click', () => {
                        if (!this.isListening) {
                            this.recognition.start();
                        }
                    });

                    this.updateStatus('üé§ –ù–∞—Ç–∏—Å–Ω–∏ –±—É–¥—å-–¥–µ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó', '#ff4081');
                } else {
                    this.updateStatus('‚ùå –ë—Ä–∞—É–∑–µ—Ä –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –º–æ–≤–∏', '#ff4444');
                }
            }

            processSpeech(text) {
                text = text.toLowerCase().trim();
                document.getElementById('words').textContent = text;
                
                // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ —Å–ª–æ–≤–∞ –∫–æ—Ö–∞–Ω–Ω—è
                const hasLoveWord = this.loveWords.some(word => 
                    text.toLowerCase().includes(word.toLowerCase())
                );

                if (hasLoveWord) {
                    this.lastSpeechTime = Date.now();
                    this.heartIntensity = Math.min(1, this.heartIntensity + 0.2);
                    this.animateHeart(this.heartIntensity);
                    this.createLoveParticles();
                    this.updateStatus('üíñ –ß—É—é —Å–ª–æ–≤–∞ –∫–æ—Ö–∞–Ω–Ω—è!', '#ff4081');
                    
                    // –ü—É–ª—å—Å–∞—Ü—ñ—è UI
                    document.getElementById('words').classList.add('pulse');
                    setTimeout(() => {
                        document.getElementById('words').classList.remove('pulse');
                    }, 500);
                } else if (Date.now() - this.lastSpeechTime > 2000) {
                    this.heartIntensity = Math.max(0.3, this.heartIntensity - 0.05);
                }
            }

            animateHeart(intensity) {
                const heart = document.querySelector('.heart-main');
                const glow = document.querySelector('.heart-glow');
                
                if (heart && glow) {
                    // –Ü–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ñ—Å—Ç—å —Å–≤—ñ—Ç—ñ–Ω–Ω—è
                    heart.setAttribute('material', {
                        emissiveIntensity: intensity,
                        color: this.getHeartColor(intensity)
                    });
                    
                    // –ê–Ω—ñ–º–∞—Ü—ñ—è –ø—É–ª—å—Å–∞—Ü—ñ—ó
                    const scale = 1 + (intensity * 0.3);
                    heart.setAttribute('animation', {
                        property: 'scale',
                        to: `${scale} ${scale} ${scale}`,
                        dur: 600 / (intensity + 0.5),
                        easing: 'easeInOutQuad',
                        loop: true,
                        dir: 'alternate'
                    });

                    // –°–≤—ñ—Ç—ñ–Ω–Ω—è
                    glow.setAttribute('material', {
                        opacity: intensity * 0.5,
                        color: this.getGlowColor(intensity)
                    });
                }
            }

            getHeartColor(intensity) {
                const r = Math.floor(255 * intensity);
                const g = Math.floor(50 * (1 - intensity));
                const b = Math.floor(100 + 155 * intensity);
                return `#${this.toHex(r)}${this.toHex(g)}${this.toHex(b)}`;
            }

            getGlowColor(intensity) {
                const r = Math.floor(255 * intensity);
                const g = Math.floor(100 * (1 - intensity));
                const b = Math.floor(150 + 105 * intensity);
                return `#${this.toHex(r)}${this.toHex(g)}${this.toHex(b)}`;
            }

            toHex(num) {
                return num.toString(16).padStart(2, '0');
            }

            createLoveParticles() {
                const particlesContainer = document.getElementById('heart-particles');
                for (let i = 0; i < 5; i++) {
                    const particle = document.createElement('a-entity');
                    const angle = Math.random() * Math.PI * 2;
                    const distance = 1 + Math.random() * 2;
                    const x = Math.cos(angle) * distance;
                    const y = Math.sin(angle) * distance * 0.5;
                    
                    particle.setAttribute('geometry', {
                        primitive: 'sphere',
                        radius: 0.1 + Math.random() * 0.1
                    });
                    particle.setAttribute('material', {
                        color: `#ff${Math.floor(80 + Math.random() * 80).toString(16)}ff`,
                        emissive: '#ff00ff',
                        emissiveIntensity: 0.8
                    });
                    particle.setAttribute('position', `${x} ${y} 0`);
                    
                    particle.setAttribute('animation', {
                        property: 'position',
                        to: `${x * 2} ${y * 2 + 2} 0`,
                        dur: 2000,
                        easing: 'easeOutQuad'
                    });
                    
                    particle.setAttribute('animation__scale', {
                        property: 'scale',
                        to: '0 0 0',
                        dur: 2000,
                        easing: 'easeInQuad'
                    });
                    
                    particlesContainer.appendChild(particle);
                    
                    setTimeout(() => {
                        if (particle.parentNode) {
                            particle.parentNode.removeChild(particle);
                        }
                    }, 2000);
                }
            }

            createFloatingHearts() {
                const container = document.getElementById('floating-hearts');
                for (let i = 0; i < 8; i++) {
                    const heart = document.createElement('a-entity');
                    const size = 0.1 + Math.random() * 0.2;
                    const angle = (i / 8) * Math.PI * 2;
                    const radius = 3 + Math.random() * 2;
                    
                    heart.setAttribute('geometry', {
                        primitive: 'sphere',
                        radius: size
                    });
                    heart.setAttribute('material', {
                        color: `#ff${Math.floor(100 + Math.random() * 155).toString(16)}${Math.floor(100 + Math.random() * 155).toString(16)}`,
                        emissive: true,
                        emissiveIntensity: 0.3
                    });
                    
                    heart.setAttribute('animation', {
                        property: 'position',
                        to: `${Math.cos(angle) * radius} ${2 + Math.sin(Date.now() * 0.001 + i) * 0.5} ${Math.sin(angle) * radius}`,
                        dur: 3000 + Math.random() * 2000,
                        easing: 'easeInOutQuad',
                        loop: true,
                        dir: 'alternate'
                    });
                    
                    heart.setAttribute('animation__scale', {
                        property: 'scale',
                        to: `${size * 1.5} ${size * 1.5} ${size * 1.5}`,
                        dur: 1500 + Math.random() * 1000,
                        easing: 'easeInOutQuad',
                        loop: true,
                        dir: 'alternate'
                    });
                    
                    container.appendChild(heart);
                }
            }

            startHeartbeat() {
                this.heartbeatInterval = setInterval(() => {
                    if (Date.now() - this.lastSpeechTime > 5000) {
                        this.heartIntensity = Math.max(0.3, this.heartIntensity - 0.02);
                    }
                    this.animateHeart(this.heartIntensity);
                }, 100);
            }

            updateStatus(message, color = '#ff4081') {
                const status = document.getElementById('status');
                if (status) {
                    status.textContent = message;
                    status.style.color = color;
                }
            }
        }

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
        document.addEventListener('DOMContentLoaded', () => {
            new MagicHeart();
        });

        // –î–æ–¥–∞—Ç–∫–æ–≤—ñ –∞—Ñ–æ—Ä–∏–∑–º–∏ –ø—Ä–æ –∫–æ—Ö–∞–Ω–Ω—è
        const loveQuotes = [
            "–ö–æ—Ö–∞–Ω–Ω—è - —Ü–µ —î–¥–∏–Ω–µ, —â–æ –∑—Ä–æ—Å—Ç–∞—î, –∫–æ–ª–∏ –Ω–∏–º –¥—ñ–ª–∏—à—Å—è",
            "–£ –∫–æ—Ö–∞–Ω–Ω—ñ –Ω–µ–º–∞—î –º–µ–∂, —è–∫ —É –∑–æ—Ä—è–Ω–æ–º—É –Ω–µ–±—ñ",
            "–°–µ—Ä—Ü–µ –±–∞—á–∏—Ç—å —Ç–µ, —â–æ –Ω–µ–≤–∏–¥–∏–º–µ –¥–ª—è –æ—á–µ–π",
            "–ö–æ—Ö–∞–Ω–Ω—è —Ä–æ–±–∏—Ç—å —Å–∏–ª—å–Ω–∏–º –Ω–∞–≤—ñ—Ç—å –Ω–∞–π—Å–ª–∞–±—à–æ–≥–æ"
        ];

        setInterval(() => {
            const wordsElement = document.getElementById('words');
            if (wordsElement && !wordsElement.textContent && Math.random() > 0.7) {
                const randomQuote = loveQuotes[Math.floor(Math.random() * loveQuotes.length)];
                wordsElement.textContent = randomQuote;
                setTimeout(() => {
                    if (wordsElement.textContent === randomQuote) {
                        wordsElement.textContent = '';
                    }
                }, 3000);
            }
        }, 5000);
    </script>
</body>
</html>
